customHeaders:
  # Sitemap and robots.txt - HIGHEST PRIORITY 
  - pattern: "/sitemap.xml"
    headers:
      - key: "Content-Type"
        value: "application/xml"
      - key: "Cache-Control"
        value: "public, max-age=3600"
  - pattern: "/robots.txt"
    headers:
      - key: "Content-Type"
        value: "text/plain"
      - key: "Cache-Control"
        value: "public, max-age=3600"

  # Your existing cache headers
  - pattern: '**/*.html'
    headers:
      - key: 'Cache-Control'
        value: 'no-cache, no-store, must-revalidate'
      - key: 'Pragma'
        value: 'no-cache'
      - key: 'Expires'
        value: '0'
  - pattern: '**/*.js'
    headers:
      - key: 'Cache-Control'
        value: 'public, max-age=31536000, immutable'
  - pattern: '**/*.css'
    headers:
      - key: 'Cache-Control'
        value: 'public, max-age=31536000, immutable'
  - pattern: '**/sw.js'
    headers:
      - key: 'Cache-Control'
        value: 'no-cache, no-store, must-revalidate'

  # FIXED: Apply security headers to specific file types, NOT all files
  - pattern: '**/*.html'
    headers:
      - key: 'X-Frame-Options'
        value: 'DENY'
      - key: 'X-Content-Type-Options'
        value: 'nosniff'
  - pattern: '**/*.js'
    headers:
      - key: 'X-Content-Type-Options'
        value: 'nosniff'
  - pattern: '**/*.css'
    headers:
      - key: 'X-Content-Type-Options'
        value: 'nosniff'

# rewrites to prevent SPA fallback
rewrites:
  - source: "/sitemap.xml"
    target: "/sitemap.xml"
    status: "200"
  - source: "/robots.txt"
    target: "/robots.txt"
    status: "200"
  - source: "</^[^.]+$|\.(?!(css|gif|ico|jpg|js|png|txt|svg|woff|woff2|ttf|map|json|xml)$)([^.]+$)/>"
    target: "/index.html"
    status: "200"